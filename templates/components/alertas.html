<!-- Alertas de Prazo -->
<div id="alertasPrazo" style="position: fixed; top: 70px; right: 20px; z-index: 1050; max-width: 400px;"></div>

<script>
// Sistema de Alertas de Prazo
function verificarPrazos() {
    fetch('/api/alertas/prazos')
        .then(response => response.json())
        .then(data => {
            if (data.success && data.alertas.length > 0) {
                mostrarAlertas(data.alertas);
            }
        });
}

function mostrarAlertas(alertas) {
    const container = $('#alertasPrazo');
    container.empty();
    
    alertas.forEach((alerta, index) => {
        const cor = alerta.tipo === 'vencido' ? 'danger' : 
                    alerta.tipo === 'hoje' ? 'warning' : 'info';
        
        const icone = alerta.tipo === 'vencido' ? 'exclamation-triangle-fill' : 
                      alerta.tipo === 'hoje' ? 'clock-fill' : 'info-circle-fill';
        
        const html = `
            <div class="alert alert-${cor} alert-dismissible fade show shadow-lg mb-2" role="alert" style="animation: slideInRight 0.5s ease-out ${index * 0.1}s both;">
                <div class="d-flex align-items-start">
                    <i class="bi bi-${icone} me-2 fs-4"></i>
                    <div class="flex-grow-1">
                        <strong>${alerta.titulo}</strong>
                        <p class="mb-1 small">${alerta.mensagem}</p>
                        <small class="text-muted">
                            <i class="bi bi-calendar-event"></i> ${alerta.data_prevista}
                        </small>
                        <br>
                        <a href="/planilha/${encodeURIComponent(alerta.aba_name)}" class="btn btn-sm btn-outline-${cor} mt-2">
                            <i class="bi bi-eye"></i> Ver Registro
                        </a>
                    </div>
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            </div>
        `;
        
        container.append(html);
    });
}

// Verificar ao carregar a p√°gina
$(document).ready(function() {
    verificarPrazos();
    
    // Verificar a cada 5 minutos
    setInterval(verificarPrazos, 5 * 60 * 1000);
});
</script>

<style>
@keyframes slideInRight {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

#alertasPrazo .alert {
    backdrop-filter: blur(10px);
    border-left: 4px solid currentColor;
}
</style>